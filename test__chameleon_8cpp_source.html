<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Fast Methods for Cosmological Simulations: src/ApproximationsSchemes/tests/test_chameleon.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Fast Methods for Cosmological Simulations
   </div>
   <div id="projectbrief">FastSim serves as a tool for quick N-body simulations in modified gravity.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('test__chameleon_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">test_chameleon.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="test__chameleon_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="catch_8hpp.html">catch.hpp</a>&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;../test.hpp&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="chameleon_8cpp.html">chameleon.cpp</a>&quot;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html">    5</a></span>&#160;<span class="keyword">namespace</span>{</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00008"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a00a81641135da27d6174dd8bbb3552b8">    8</a></span>&#160;<a class="code" href="namespacegrowth__allz.html#ab81fcc062af182c48f3ebb9b362d04aa">T</a> <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#aea22201ea94c61c9002645b660895808">mean</a>(<span class="keyword">const</span> std::vector&lt;T&gt;&amp; data)</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="namespacegrowth__allz.html#ab81fcc062af182c48f3ebb9b362d04aa">T</a> tmp(0);</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    </div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">    #pragma omp parallel for reduction(+:tmp)</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = data.begin(); it &lt; data.end(); ++it) tmp += *it;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    </div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keywordflow">return</span> tmp / data.size();</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#aea22201ea94c61c9002645b660895808">   18</a></span>&#160;FTYPE_t <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#aea22201ea94c61c9002645b660895808">mean</a>(<span class="keyword">const</span> <a class="code" href="classMesh.html">Mesh</a>&amp; data){ <span class="keywordflow">return</span> <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#aea22201ea94c61c9002645b660895808">mean</a>(data.<a class="code" href="classMesh__base.html#ae11f32b9159dca4ffbea831a91e65625">data</a>); }</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a8709442cd76b43b8ba10b02bef781eae">   20</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a8709442cd76b43b8ba10b02bef781eae">get_neighbor_gridindex</a>(std::vector&lt;size_t&gt;&amp; index_list, <span class="keywordtype">size_t</span> i, <span class="keywordtype">size_t</span> N)</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;{</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    index_list = std::vector&lt;size_t&gt;(7);</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    index_list[0] = i;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> j = 0, n = 1; j &lt; 3; j++, n *= N){</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;        <span class="keywordtype">size_t</span> ii = i/n % N;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;        <span class="keywordtype">size_t</span> iminus = ii &gt;= 1   ? ii - 1 : N - 1;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordtype">size_t</span> iplus  = ii &lt;= N-2 ? ii + 1 : 0;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        index_list[2*j+1] = i + (iminus - ii) * n;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        index_list[2*j+2] = i + (iplus - ii) * n;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a87dc2de9b91725a68142772257b33529">   33</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a87dc2de9b91725a68142772257b33529">init_overdensity</a>(<a class="code" href="classSim__Param.html">Sim_Param</a>&amp; sim, <a class="code" href="classMesh.html">Mesh</a>&amp; rho, <a class="code" href="classMultiGrid.html">MultiGrid&lt;3, CHI_PREC_t&gt;</a>&amp; rho_grid)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> N = sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#abacba4809c19fc88790728794cf498bc">N_grid</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="keyword">const</span> FTYPE_t R = sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#a44481582a0066e7934eb9313b9714358">R_sphere</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="keyword">const</span> FTYPE_t rho_0 = sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#ae7be45db344f1287ac9488ccb6e263a1">rho_sphere</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> N_tot = rho.<a class="code" href="classMesh__base.html#a6de1809464dd96aa985aa3141e1e4fe4">length</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    FTYPE_t mean_rho;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    FTYPE_t R2_;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <span class="keyword">const</span> FTYPE_t R2 = R*R;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordtype">size_t</span> ix0 = N/2, iy0 = N/2, iz0 = N/2;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    </div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">    #pragma omp parallel for private(R2_)</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ix = 0; ix &lt; N; ++ix)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    {</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iy = 0; iy &lt; N; ++iy)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        {</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespacemfunc__bm.html#a7f72660538363e59e3883527c42fd8df">iz</a> = 0; <a class="code" href="namespacemfunc__bm.html#a7f72660538363e59e3883527c42fd8df">iz</a> &lt; N; ++<a class="code" href="namespacemfunc__bm.html#a7f72660538363e59e3883527c42fd8df">iz</a>)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;            {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                R2_ = <a class="code" href="precision_8hpp.html#a9652c2bd895de1be056b015c36c27fa5">pow2</a>(ix - ix0) + <a class="code" href="precision_8hpp.html#a9652c2bd895de1be056b015c36c27fa5">pow2</a>(iy - iy0) + <a class="code" href="precision_8hpp.html#a9652c2bd895de1be056b015c36c27fa5">pow2</a>(<a class="code" href="namespacemfunc__bm.html#a7f72660538363e59e3883527c42fd8df">iz</a> - iz0);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                rho(ix, iy, <a class="code" href="namespacemfunc__bm.html#a7f72660538363e59e3883527c42fd8df">iz</a>) = R2_ &lt;= R2 ? rho_0 : 0;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;            }</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        }</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    }</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    mean_rho = <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#aea22201ea94c61c9002645b660895808">mean</a>(rho);</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span> (mean_rho &gt; 1) <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;invalid values of sphere parameters (overdensity: &quot;</span> + std::to_string(-mean_rho) + <span class="stringliteral">&quot; &lt; -1)&quot;</span>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    rho -= mean_rho;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a613d248dbb7774ffde4dd2d667c62a6a">transform_Mesh_to_MultiGrid</a>(rho, rho_grid);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// check density</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a>( <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#aea22201ea94c61c9002645b660895808">mean</a>(rho) == <a class="code" href="classCatch_1_1Detail_1_1Approx.html">Approx</a>(0.) );</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a>( rho(ix0, iy0, iz0) == <a class="code" href="classCatch_1_1Detail_1_1Approx.html">Approx</a>(rho_0 - mean_rho) );</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a>( rho(0, 0, 0) == <a class="code" href="classCatch_1_1Detail_1_1Approx.html">Approx</a>(-mean_rho) );</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// update background underdensity</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#af2092a24ca6b1491434ce50a89dd7edf">rho_b</a> = -mean_rho;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;}</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a9df5a2c1ea9aaaee33569bd05892e2e7">   73</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a9df5a2c1ea9aaaee33569bd05892e2e7">get_grav_pot</a>(<a class="code" href="classMesh.html">Mesh</a>&amp; rho, <span class="keyword">const</span> <a class="code" href="precision_8hpp.html#a11fcca3b616ecb9d6cf05b3068a3efa2">FFTW_PLAN_TYPE</a>&amp; p_F, <span class="keyword">const</span> <a class="code" href="precision_8hpp.html#a11fcca3b616ecb9d6cf05b3068a3efa2">FFTW_PLAN_TYPE</a>&amp; p_B, FTYPE_t box_size, FTYPE_t phi_prefactor)</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;{</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="core__mesh_8cpp.html#aa299a7e2d29780cfc0d59345e5d4c8f1">fftw_execute_dft_r2c</a>(p_F, rho);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <a class="code" href="core__app_8cpp.html#a592649d2f19cdf7771d3b0c09ed16d91">gen_pot_k</a>(rho);</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="core__mesh_8cpp.html#a8198907dd10006d2e45450bb13a7242a">fftw_execute_dft_c2r</a>(p_B, rho);</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    rho *= <a class="code" href="precision_8hpp.html#a5fedfe83ec3d318ed43c72e5f42f2861">pow</a>(box_size / rho.<a class="code" href="classMesh.html#aa0a3685f21d4bf9f7241c166bf6de087">N</a>, 2) <span class="comment">// computing units (laplace)</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        *  phi_prefactor; <span class="comment">// prefactor of poisson equation</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;}</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a3a76f0c979f6c5e35e400e8b9e7e94d2">   82</a></span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="core__mesh_8cpp.html#a72285b0564f202218b9c5742a7b3b936">sgn</a>(<a class="code" href="namespacegrowth__allz.html#ab81fcc062af182c48f3ebb9b362d04aa">T</a> val)</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;{</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="namespacegrowth__allz.html#ab81fcc062af182c48f3ebb9b362d04aa">T</a>(0) &lt; val) - (val &lt; <a class="code" href="namespacegrowth__allz.html#ab81fcc062af182c48f3ebb9b362d04aa">T</a>(0));</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;}</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a23f796ef819d6f00bc98d727cf2b694d">   87</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a23f796ef819d6f00bc98d727cf2b694d">print_mesh</a>(<span class="keyword">const</span> std::string&amp; file_name, <span class="keyword">const</span> <a class="code" href="classMesh.html">Mesh</a>&amp; pot, <span class="keyword">const</span> FTYPE_t mod = -1 - <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#af82d4568744e78bd64b365feaaa262a8">CHI_MIN</a>)</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classOfstream.html">Ofstream</a> File(file_name);</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordtype">size_t</span> N = pot.<a class="code" href="classMesh.html#aa0a3685f21d4bf9f7241c166bf6de087">N</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordtype">int</span> ix0 = N/2, iy0 = N/2, iz0 = N/2;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keyword">auto</span> print_r_chi = [&amp;File, ix0, iy0, iz0,&amp;pot, mod]</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                       (<span class="keywordtype">int</span> i, <span class="keywordtype">int</span> j, <span class="keywordtype">int</span> k)</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                        {</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                            <a class="code" href="classVec__3D.html">Vec_3D&lt;size_t&gt;</a> pos(i, j, k); <span class="comment">//&lt; to call periodic position on Mesh</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                            FTYPE_t r = <a class="code" href="grid_8h.html#a279b2fa20d574895e6286adb664cd1e9">sqrt</a>(<a class="code" href="precision_8hpp.html#a9652c2bd895de1be056b015c36c27fa5">pow2</a>(i - ix0) + <a class="code" href="precision_8hpp.html#a9652c2bd895de1be056b015c36c27fa5">pow2</a>(j - iy0) + <a class="code" href="precision_8hpp.html#a9652c2bd895de1be056b015c36c27fa5">pow2</a>(k - iz0));</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                            File &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; pot(pos) + mod  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                        };</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; N; ++i)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        print_r_chi(i, i, i);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        print_r_chi(i, i, i + 1);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        print_r_chi(i, i + 1, i + 1);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    }</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;}</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;} <span class="comment">// namespace &lt;unique&gt; end</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="test__chameleon_8cpp.html#a657a834a319a49366487fe2221250852">  111</a></span>&#160;<a class="code" href="test__chameleon_8cpp.html#a657a834a319a49366487fe2221250852">TEST_CASE</a>( <span class="stringliteral">&quot;UNIT TEST: create Multigrid and copy data to/from Mesh&quot;</span>, <span class="stringliteral">&quot;[multigrid]&quot;</span> )</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    print_unit_msg(<span class="stringliteral">&quot;create Multigrid and copy data to/from Mesh&quot;</span>);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    constexpr <span class="keywordtype">size_t</span> N = 32;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    srand(time(0));</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="classMultiGrid.html">MultiGrid&lt;3, FTYPE_t&gt;</a> grid(N);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="classMesh.html">Mesh</a> mesh_from(N);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="classMesh.html">Mesh</a> mesh_to(N);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">const</span> std::vector&lt;size_t&gt; some_indices = <span class="comment">// Mesh indices = N*N*(N+2)</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                            {4, <span class="comment">// (0, 0, 4)</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                            (N+2)*2+5, <span class="comment">// (0, 2, 5)</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                                            N*(N+2)*4+8*(N+2)+5}; <span class="comment">// (4, 8, 5)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i : some_indices) mesh_from[i] = 2.0*rand()/RAND_MAX - 1;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a613d248dbb7774ffde4dd2d667c62a6a">transform_Mesh_to_MultiGrid</a>(mesh_from, grid);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="catch_8hpp.html#a836cca6b6ed3a1706353f6d1bca0935f">CHECK</a>(<a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#ab83251d24f40182ea733a2eef4d3937e">min</a>(mesh_from) == <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#ab83251d24f40182ea733a2eef4d3937e">min</a>(grid));</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a3698277e18f25625986cf66a10adde3e">transform_MultiGrid_to_Mesh</a>(mesh_to, grid);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i : some_indices) <a class="code" href="catch_8hpp.html#a836cca6b6ed3a1706353f6d1bca0935f">CHECK</a>( mesh_from[i] == mesh_to[i] );</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="catch_8hpp.html#a836cca6b6ed3a1706353f6d1bca0935f">CHECK</a>(<a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#ab83251d24f40182ea733a2eef4d3937e">min</a>(mesh_from) == <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#ab83251d24f40182ea733a2eef4d3937e">min</a>(grid));</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="catch_8hpp.html#a836cca6b6ed3a1706353f6d1bca0935f">CHECK</a>(<a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#ab83251d24f40182ea733a2eef4d3937e">min</a>(mesh_to) == <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#ab83251d24f40182ea733a2eef4d3937e">min</a>(grid));</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="test__chameleon_8cpp.html#a4c122c66abd519a145a9ca7d0fd3df97">  136</a></span>&#160;<a class="code" href="test__chameleon_8cpp.html#a657a834a319a49366487fe2221250852">TEST_CASE</a>( <span class="stringliteral">&quot;UNIT TEST: create and initialize ChiSolver, check bulk field&quot;</span>, <span class="stringliteral">&quot;[chameleon]&quot;</span> )</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    print_unit_msg(<span class="stringliteral">&quot;create and initialize ChiSolver, check bulk field&quot;</span>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    constexpr <span class="keywordtype">size_t</span> N = 32;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    constexpr FTYPE_t a = 0.5;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    constexpr FTYPE_t rho_0 = 0.3;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keyword">const</span> std::vector&lt;size_t&gt; some_indices = <span class="comment">// Mesh indices = N*N*(N+2)</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                            {4, <span class="comment">// (0, 0, 4)</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                            (N+2)*2+5, <span class="comment">// (0, 2, 5)</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                            N*(N+2)*4+8*(N+2)+5}; <span class="comment">// (4, 8, 5)</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="comment">// initialize Sim_Param</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> argc = 1;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code" href="namespaceccl__test__power.html#a1b5fdf14c4f06d4a8722a7c41d8dbe1a">argv</a>[1] = {<span class="stringliteral">&quot;test&quot;</span>};</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <a class="code" href="classSim__Param.html">Sim_Param</a> sim(argc, argv);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// check thowing of exception with unphysical values of chameleon parameters</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keyword">auto</span> constructor = [&amp;sim](){ ChiSolver&lt;FTYPE_t&gt; _sol(N, sim, <span class="keyword">false</span>); };</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    sim.<a class="code" href="classSim__Param.html#a13168f8190098b1d35cf487af699edb6">chi_opt</a>.<a class="code" href="structChi__Opt.html#a1385728a7cf22fbb099685473a28517c">n</a> = -1;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="catch_8hpp.html#a1fb6439098d2a12bb69188034e03baf2">CHECK_THROWS_AS</a>( constructor(), std::out_of_range );</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    sim.<a class="code" href="classSim__Param.html#a13168f8190098b1d35cf487af699edb6">chi_opt</a>.<a class="code" href="structChi__Opt.html#a1385728a7cf22fbb099685473a28517c">n</a> = 0.5;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    sim.<a class="code" href="classSim__Param.html#a13168f8190098b1d35cf487af699edb6">chi_opt</a>.<a class="code" href="structChi__Opt.html#a5279fd76c5388819ae9f285dd9b67aad">beta</a> = -1;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="catch_8hpp.html#a1fb6439098d2a12bb69188034e03baf2">CHECK_THROWS_AS</a>( constructor(), std::out_of_range );</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">// initialize ChiSolver</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    sim.<a class="code" href="classSim__Param.html#a13168f8190098b1d35cf487af699edb6">chi_opt</a>.<a class="code" href="structChi__Opt.html#a5279fd76c5388819ae9f285dd9b67aad">beta</a> = 1/<a class="code" href="grid_8h.html#a279b2fa20d574895e6286adb664cd1e9">sqrt</a>(6.);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    ChiSolver&lt;FTYPE_t&gt; sol(N, sim, <span class="keyword">false</span>);</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// check thowing of exceptions in uninitialised state</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="catch_8hpp.html#a1fb6439098d2a12bb69188034e03baf2">CHECK_THROWS_AS</a>( sol.set_bulk_field(), std::out_of_range );</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">// initialize overdensity -- constant density</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="classMultiGrid.html">MultiGrid&lt;3, FTYPE_t&gt;</a> rho_grid(N);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    {</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <a class="code" href="classMesh.html">Mesh</a> rho(N);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        rho.<a class="code" href="classMesh__base.html#a3a99a6958058475cdfe263288151e850">assign</a>(rho_0);</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a613d248dbb7774ffde4dd2d667c62a6a">transform_Mesh_to_MultiGrid</a>(rho, rho_grid);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// check density</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i : some_indices) <a class="code" href="catch_8hpp.html#a836cca6b6ed3a1706353f6d1bca0935f">CHECK</a>( rho_grid[0][i] == rho_0 );</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="comment">// set ChiSolver -- bulk field</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    sol.set_time(a, sim.<a class="code" href="classSim__Param.html#a2f31362e8d3cdc782accfc86bb183dba">cosmo</a>);</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    sol.add_external_grid(&amp;rho_grid);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    sol.set_bulk_field();</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="comment">// check bulk field</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keyword">const</span> FTYPE_t chi_bulk = sol.chi_min(rho_0);</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        FTYPE_t <span class="keyword">const</span>* <span class="keyword">const</span> chi = sol.get_y();</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i : some_indices) <a class="code" href="catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a>( chi[i] == <a class="code" href="classCatch_1_1Detail_1_1Approx.html">Approx</a>(chi_bulk));</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// check that EOM is satisfied</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    std::vector&lt;size_t&gt; index_list;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">size_t</span> level = 0;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keyword">const</span> FTYPE_t <a class="code" href="namespaceccl__test__distances.html#a6657d9200f3deee33876fcfbe909ad0b">h</a> = 1.0/FTYPE_t( sol.get_N(level) );</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i : some_indices)</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a8709442cd76b43b8ba10b02bef781eae">get_neighbor_gridindex</a>(index_list, i, N);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <a class="code" href="catch_8hpp.html#a836cca6b6ed3a1706353f6d1bca0935f">CHECK</a>( sol.l_operator(level, index_list, <span class="keyword">true</span>, h) == <a class="code" href="classCatch_1_1Detail_1_1Approx.html">Approx</a>(0.));</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="test__chameleon_8cpp.html#a9bb7c8462c3a0d9d906b2cf4de05f2a1">  202</a></span>&#160;<a class="code" href="test__chameleon_8cpp.html#a657a834a319a49366487fe2221250852">TEST_CASE</a>( <span class="stringliteral">&quot;UNIT TEST: create and initialize ChiSolver, solve sphere&quot;</span>, <span class="stringliteral">&quot;[chameleon]&quot;</span> )</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    print_unit_msg(<span class="stringliteral">&quot;create and initialize ChiSolver, solve sphere&quot;</span>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// initialize Sim_Param</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <a class="code" href="namespaceccl__test__power.html#a1b5fdf14c4f06d4a8722a7c41d8dbe1a">argv</a>[1] = {<span class="stringliteral">&quot;test&quot;</span>};</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="classSim__Param.html">Sim_Param</a> sim(1, argv);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> N = sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#abacba4809c19fc88790728794cf498bc">N_grid</a>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> N_min = sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#a96a06cb78d2a65ad74fd180b525603ed">N_min</a>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> verbose = sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#a2e59a5cf8262a444cbc229f5d04318de">verbose</a>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="comment">// initialize ChiSolver</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    ChiSolver&lt;CHI_PREC_t&gt; sol(N, N_min, sim, verbose);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="comment">// initialize overdensity -- constant density in sphere of radius R, center at x0, y0, z0</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classMultiGrid.html">MultiGrid&lt;3, CHI_PREC_t&gt;</a> rho_grid(N);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="classMesh.html">Mesh</a> rho(N);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a87dc2de9b91725a68142772257b33529">init_overdensity</a>(sim, rho, rho_grid);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// FFTW preparation</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="precision_8hpp.html#a28cc624e213909e713d2197891cbd5a8">FFTW_PLAN_OMP_INIT</a>()){</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Errors during multi-thread initialization&quot;</span>);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="precision_8hpp.html#a281c03e36a8aa123ff492f0b5fbd9da9">FFTW_PLAN_OMP</a>(sim.<a class="code" href="classSim__Param.html#a8df59df5e696db2bf7aa9260ae6ab123">run_opt</a>.<a class="code" href="structRun__Opt.html#a5bcfeacfcc007d94efac7a1bb215666a">nt</a>);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">const</span> <a class="code" href="precision_8hpp.html#a11fcca3b616ecb9d6cf05b3068a3efa2">FFTW_PLAN_TYPE</a> p_F = <a class="code" href="precision_8hpp.html#a1e4e2bcf89b30dfb7b0079da0c7dfd60">FFTW_PLAN_R2C</a>(N, N, N, rho.<a class="code" href="classMesh__base.html#a3bf9bb3d5a14aac8f5841dab51fe1962">real</a>(), rho.<a class="code" href="classMesh.html#a637b08e6a2359acf3902f2099b374bc8">complex</a>(), FFTW_ESTIMATE);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">const</span> <a class="code" href="precision_8hpp.html#a11fcca3b616ecb9d6cf05b3068a3efa2">FFTW_PLAN_TYPE</a> p_B = <a class="code" href="precision_8hpp.html#ac98a622063c2f9cf2319a2a0914d30b7">FFTW_PLAN_C2R</a>(N, N, N, rho.<a class="code" href="classMesh.html#a637b08e6a2359acf3902f2099b374bc8">complex</a>(), rho.<a class="code" href="classMesh__base.html#a3bf9bb3d5a14aac8f5841dab51fe1962">real</a>(), FFTW_ESTIMATE);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// set ChiSolver</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    sol.set_time(1, sim.<a class="code" href="classSim__Param.html#a2f31362e8d3cdc782accfc86bb183dba">cosmo</a>);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    sol.set_def_convergence();</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    sol.add_external_grid(&amp;rho_grid);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    sol.set_ngs_sweeps(sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#a672ef5869f774cdd15aad9e7979ce644">fine_sweeps</a>, sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#aa9d524be0f8408c9b15bf0a016ca29e9">coarse_sweeps</a>); <span class="comment">//&lt; fine, coarse</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// compute gravitational potential</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="classMesh.html">Mesh</a> phi_pot(rho); <span class="comment">//&lt; copy density</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a9df5a2c1ea9aaaee33569bd05892e2e7">get_grav_pot</a>(phi_pot, p_F, p_B, sim.<a class="code" href="classSim__Param.html#a30f446d0ed488472876271412d28a34b">box_opt</a>.<a class="code" href="structBox__Opt.html#aabaa342d0f674e4868f00561999b740c">box_size</a>, sol.get_phi_prefactor());</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="comment">// get linear prediction</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    sol.set_linear(rho, p_F, p_B);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    sol.set_screened();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// full solution on Mesh</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="classMesh.html">Mesh</a> chi_full(N);</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// create directory structure</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    std::string out_dir = sim.<a class="code" href="classSim__Param.html#a66ac6a79379b67cbe941a0abb8efedbe">out_opt</a>.<a class="code" href="structOut__Opt.html#ab5d498b927d5d68709dd1a611d2e523b">out_dir</a> + <span class="stringliteral">&quot;test_ChiSolver/&quot;</span>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="core__out_8cpp.html#ad5b79e0949f8701d1443de2b177c8718">remove_all_files</a>(out_dir);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="core__out_8cpp.html#a2efd6fa7e566267f1ede703138af72a1">create_dir</a>(out_dir);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    sim.<a class="code" href="classSim__Param.html#a2844b607e49ae018fbe8597be984a553">print_info</a>(out_dir, <span class="stringliteral">&quot;test&quot;</span>);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    <span class="comment">// print gravitational potential</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a23f796ef819d6f00bc98d727cf2b694d">print_mesh</a>(out_dir + <span class="stringliteral">&quot;grav_pot.dat&quot;</span>, phi_pot, 0);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// Solve the equation -- full V-cycles</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    BOOST_LOG_TRIVIAL(info) &lt;&lt; <span class="stringliteral">&quot;Starting V-cycles with intermediate output...\n&quot;</span>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    </div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordtype">int</span> istep = 0;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">size_t</span> step_per_iter = sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#acf1d6941edb96bf58a95c4026f0cae86">step_per_iter</a>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordflow">while</span>(1)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// istep, max_step (use int for the last iteration -- negative max_step)</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        istep += sol.get_istep();</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordtype">int</span> max_step = istep + step_per_iter &gt; sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#ae0512ff5aaaaf4f50cc2e985ad419dfd">max_steps</a> ? sim.<a class="code" href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">test_opt</a>.<a class="code" href="structTest__Opt.html#ae0512ff5aaaaf4f50cc2e985ad419dfd">max_steps</a> - istep : step_per_iter;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="comment">// print chi_full</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        <a class="code" href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a16143935cee36c9b6799b020794d0b57">transform_MultiGridSolver_to_Mesh</a>(chi_full, sol);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <a class="code" href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a23f796ef819d6f00bc98d727cf2b694d">print_mesh</a>(out_dir + <span class="stringliteral">&quot;chi_istep_&quot;</span> + std::to_string(istep) + <span class="stringliteral">&quot;.dat&quot;</span>, chi_full);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="comment">// check max_step and convergence</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">if</span> ((max_step &lt;= 0) || ((istep != 0) &amp;&amp; (sol.get_istep() &lt; step_per_iter))) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="comment">// set &amp; solve</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        sol.set_maxsteps(max_step);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        sol.solve();</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// FFTW CLEANUP</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="precision_8hpp.html#aedb119751170eac2c67886d524de00f0">FFTW_DEST_PLAN</a>(p_F);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="precision_8hpp.html#aedb119751170eac2c67886d524de00f0">FFTW_DEST_PLAN</a>(p_B);</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="precision_8hpp.html#a23f8a2188115cb3d27809adb429db284">FFTW_PLAN_OMP_CLEAN</a>();</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div><div class="ttc" id="classSim__Param_html_a13168f8190098b1d35cf487af699edb6"><div class="ttname"><a href="classSim__Param.html#a13168f8190098b1d35cf487af699edb6">Sim_Param::chi_opt</a></div><div class="ttdeci">Chi_Opt chi_opt</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00210">params.hpp:210</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02test__chameleon_8cpp_03_html_a23f796ef819d6f00bc98d727cf2b694d"><div class="ttname"><a href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a23f796ef819d6f00bc98d727cf2b694d">anonymous_namespace{test_chameleon.cpp}::print_mesh</a></div><div class="ttdeci">void print_mesh(const std::string &amp;file_name, const Mesh &amp;pot, const double mod=-1-CHI_MIN)</div><div class="ttdef"><b>Definition:</b> <a href="test__chameleon_8cpp_source.html#l00087">test_chameleon.cpp:87</a></div></div>
<div class="ttc" id="structBox__Opt_html_aabaa342d0f674e4868f00561999b740c"><div class="ttname"><a href="structBox__Opt.html#aabaa342d0f674e4868f00561999b740c">Box_Opt::box_size</a></div><div class="ttdeci">double box_size</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00059">params.hpp:59</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02chameleon_8cpp_03_html_af82d4568744e78bd64b365feaaa262a8"><div class="ttname"><a href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#af82d4568744e78bd64b365feaaa262a8">anonymous_namespace{chameleon.cpp}::CHI_MIN</a></div><div class="ttdeci">constexpr CHI_PREC_t CHI_MIN</div><div class="ttdoc">minimum value of chameleon field, in chi_a units it is &amp;#39;0&amp;#39;, in phi units it is &amp;#39;-1&amp;#39; ...</div><div class="ttdef"><b>Definition:</b> <a href="chameleon_8cpp_source.html#l00066">chameleon.cpp:66</a></div></div>
<div class="ttc" id="classMesh_html_a637b08e6a2359acf3902f2099b374bc8"><div class="ttname"><a href="classMesh.html#a637b08e6a2359acf3902f2099b374bc8">Mesh::complex</a></div><div class="ttdeci">FFTW_COMPLEX_TYPE * complex()</div><div class="ttdoc">get fftw_complex pointer to data </div><div class="ttdef"><b>Definition:</b> <a href="class__mesh_8hpp_source.html#l00111">class_mesh.hpp:111</a></div></div>
<div class="ttc" id="catch_8hpp_html_a1fb6439098d2a12bb69188034e03baf2"><div class="ttname"><a href="catch_8hpp.html#a1fb6439098d2a12bb69188034e03baf2">CHECK_THROWS_AS</a></div><div class="ttdeci">#define CHECK_THROWS_AS(expr, exceptionType)</div><div class="ttdef"><b>Definition:</b> <a href="catch_8hpp_source.html#l13867">catch.hpp:13867</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02chameleon_8cpp_03_html_a16143935cee36c9b6799b020794d0b57"><div class="ttname"><a href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a16143935cee36c9b6799b020794d0b57">anonymous_namespace{chameleon.cpp}::transform_MultiGridSolver_to_Mesh</a></div><div class="ttdeci">void transform_MultiGridSolver_to_Mesh(Mesh &amp;mesh, const MultiGridSolver&lt; 3, T &gt; &amp;sol)</div><div class="ttdef"><b>Definition:</b> <a href="chameleon_8cpp_source.html#l00137">chameleon.cpp:137</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02chameleon_8cpp_03_html_a3698277e18f25625986cf66a10adde3e"><div class="ttname"><a href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a3698277e18f25625986cf66a10adde3e">anonymous_namespace{chameleon.cpp}::transform_MultiGrid_to_Mesh</a></div><div class="ttdeci">void transform_MultiGrid_to_Mesh(Mesh &amp;mesh, const MultiGrid&lt; 3, T &gt; &amp;mltgrid)</div><div class="ttdef"><b>Definition:</b> <a href="chameleon_8cpp_source.html#l00134">chameleon.cpp:134</a></div></div>
<div class="ttc" id="classSim__Param_html_a30f446d0ed488472876271412d28a34b"><div class="ttname"><a href="classSim__Param.html#a30f446d0ed488472876271412d28a34b">Sim_Param::box_opt</a></div><div class="ttdeci">Box_Opt box_opt</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00202">params.hpp:202</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02test__chameleon_8cpp_03_html_a87dc2de9b91725a68142772257b33529"><div class="ttname"><a href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a87dc2de9b91725a68142772257b33529">anonymous_namespace{test_chameleon.cpp}::init_overdensity</a></div><div class="ttdeci">void init_overdensity(Sim_Param &amp;sim, Mesh &amp;rho, MultiGrid&lt; 3, CHI_PREC_t &gt; &amp;rho_grid)</div><div class="ttdef"><b>Definition:</b> <a href="test__chameleon_8cpp_source.html#l00033">test_chameleon.cpp:33</a></div></div>
<div class="ttc" id="classMesh__base_html_a3bf9bb3d5a14aac8f5841dab51fe1962"><div class="ttname"><a href="classMesh__base.html#a3bf9bb3d5a14aac8f5841dab51fe1962">Mesh_base::real</a></div><div class="ttdeci">T * real()</div><div class="ttdef"><b>Definition:</b> <a href="class__mesh_8hpp_source.html#l00036">class_mesh.hpp:36</a></div></div>
<div class="ttc" id="core__out_8cpp_html_ad5b79e0949f8701d1443de2b177c8718"><div class="ttname"><a href="core__out_8cpp.html#ad5b79e0949f8701d1443de2b177c8718">remove_all_files</a></div><div class="ttdeci">void remove_all_files(const std::string &amp;out_dir)</div><div class="ttdef"><b>Definition:</b> <a href="core__out_8cpp_source.html#l00092">core_out.cpp:92</a></div></div>
<div class="ttc" id="classSim__Param_html"><div class="ttname"><a href="classSim__Param.html">Sim_Param</a></div><div class="ttdoc">: class storing simulation parameters </div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00193">params.hpp:193</a></div></div>
<div class="ttc" id="catch_8hpp_html"><div class="ttname"><a href="catch_8hpp.html">catch.hpp</a></div></div>
<div class="ttc" id="core__mesh_8cpp_html_aa299a7e2d29780cfc0d59345e5d4c8f1"><div class="ttname"><a href="core__mesh_8cpp.html#aa299a7e2d29780cfc0d59345e5d4c8f1">fftw_execute_dft_r2c</a></div><div class="ttdeci">void fftw_execute_dft_r2c(const FFTW_PLAN_TYPE &amp;p_F, Mesh &amp;rho)</div><div class="ttdoc">compute forward (real to complex) FFT on mesh (inplace) </div><div class="ttdef"><b>Definition:</b> <a href="core__mesh_8cpp_source.html#l00247">core_mesh.cpp:247</a></div></div>
<div class="ttc" id="classMesh_html"><div class="ttname"><a href="classMesh.html">Mesh</a></div><div class="ttdoc">: creates a mesh of N*N*(N+2) cells </div><div class="ttdef"><b>Definition:</b> <a href="class__mesh_8hpp_source.html#l00095">class_mesh.hpp:95</a></div></div>
<div class="ttc" id="namespacegrowth__allz_html_ab81fcc062af182c48f3ebb9b362d04aa"><div class="ttname"><a href="namespacegrowth__allz.html#ab81fcc062af182c48f3ebb9b362d04aa">growth_allz.T</a></div><div class="ttdeci">T</div><div class="ttdef"><b>Definition:</b> <a href="growth__allz_8py_source.html#l00026">growth_allz.py:26</a></div></div>
<div class="ttc" id="structTest__Opt_html_acf1d6941edb96bf58a95c4026f0cae86"><div class="ttname"><a href="structTest__Opt.html#acf1d6941edb96bf58a95c4026f0cae86">Test_Opt::step_per_iter</a></div><div class="ttdeci">size_t step_per_iter</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00149">params.hpp:149</a></div></div>
<div class="ttc" id="precision_8hpp_html_a9652c2bd895de1be056b015c36c27fa5"><div class="ttname"><a href="precision_8hpp.html#a9652c2bd895de1be056b015c36c27fa5">pow2</a></div><div class="ttdeci">T pow2(T base)</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00052">precision.hpp:52</a></div></div>
<div class="ttc" id="classMesh__base_html_ae11f32b9159dca4ffbea831a91e65625"><div class="ttname"><a href="classMesh__base.html#ae11f32b9159dca4ffbea831a91e65625">Mesh_base::data</a></div><div class="ttdeci">std::vector&lt; T &gt; data</div><div class="ttdef"><b>Definition:</b> <a href="class__mesh_8hpp_source.html#l00033">class_mesh.hpp:33</a></div></div>
<div class="ttc" id="structTest__Opt_html_a44481582a0066e7934eb9313b9714358"><div class="ttname"><a href="structTest__Opt.html#a44481582a0066e7934eb9313b9714358">Test_Opt::R_sphere</a></div><div class="ttdeci">double R_sphere</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00148">params.hpp:148</a></div></div>
<div class="ttc" id="namespacemfunc__bm_html_a7f72660538363e59e3883527c42fd8df"><div class="ttname"><a href="namespacemfunc__bm.html#a7f72660538363e59e3883527c42fd8df">mfunc_bm.iz</a></div><div class="ttdeci">int iz</div><div class="ttdef"><b>Definition:</b> <a href="mfunc__bm_8py_source.html#l00017">mfunc_bm.py:17</a></div></div>
<div class="ttc" id="precision_8hpp_html_ac98a622063c2f9cf2319a2a0914d30b7"><div class="ttname"><a href="precision_8hpp.html#ac98a622063c2f9cf2319a2a0914d30b7">FFTW_PLAN_C2R</a></div><div class="ttdeci">#define FFTW_PLAN_C2R</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00030">precision.hpp:30</a></div></div>
<div class="ttc" id="core__mesh_8cpp_html_a8198907dd10006d2e45450bb13a7242a"><div class="ttname"><a href="core__mesh_8cpp.html#a8198907dd10006d2e45450bb13a7242a">fftw_execute_dft_c2r</a></div><div class="ttdeci">void fftw_execute_dft_c2r(const FFTW_PLAN_TYPE &amp;p_B, Mesh &amp;rho)</div><div class="ttdoc">compute backward (complex to real) FFT on mesh (inplace) </div><div class="ttdef"><b>Definition:</b> <a href="core__mesh_8cpp_source.html#l00253">core_mesh.cpp:253</a></div></div>
<div class="ttc" id="structChi__Opt_html_a1385728a7cf22fbb099685473a28517c"><div class="ttname"><a href="structChi__Opt.html#a1385728a7cf22fbb099685473a28517c">Chi_Opt::n</a></div><div class="ttdeci">double n</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00185">params.hpp:185</a></div></div>
<div class="ttc" id="classVec__3D_html"><div class="ttname"><a href="classVec__3D.html">Vec_3D&lt; size_t &gt;</a></div></div>
<div class="ttc" id="core__app_8cpp_html_a592649d2f19cdf7771d3b0c09ed16d91"><div class="ttname"><a href="core__app_8cpp.html#a592649d2f19cdf7771d3b0c09ed16d91">gen_pot_k</a></div><div class="ttdeci">void gen_pot_k(const Mesh &amp;rho_k, Mesh &amp;pot_k)</div><div class="ttdef"><b>Definition:</b> <a href="core__app_8cpp_source.html#l00496">core_app.cpp:496</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02chameleon_8cpp_03_html_a613d248dbb7774ffde4dd2d667c62a6a"><div class="ttname"><a href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#a613d248dbb7774ffde4dd2d667c62a6a">anonymous_namespace{chameleon.cpp}::transform_Mesh_to_MultiGrid</a></div><div class="ttdeci">void transform_Mesh_to_MultiGrid(const Mesh &amp;mesh, MultiGrid&lt; 3, T &gt; &amp;mltgrid)</div><div class="ttdef"><b>Definition:</b> <a href="chameleon_8cpp_source.html#l00108">chameleon.cpp:108</a></div></div>
<div class="ttc" id="catch_8hpp_html_ad57835ba8f1bb419a865ada6bd011a85"><div class="ttname"><a href="catch_8hpp.html#ad57835ba8f1bb419a865ada6bd011a85">REQUIRE</a></div><div class="ttdeci">#define REQUIRE(...)</div><div class="ttdef"><b>Definition:</b> <a href="catch_8hpp_source.html#l13849">catch.hpp:13849</a></div></div>
<div class="ttc" id="structTest__Opt_html_ae7be45db344f1287ac9488ccb6e263a1"><div class="ttname"><a href="structTest__Opt.html#ae7be45db344f1287ac9488ccb6e263a1">Test_Opt::rho_sphere</a></div><div class="ttdeci">double rho_sphere</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00148">params.hpp:148</a></div></div>
<div class="ttc" id="classSim__Param_html_a2f31362e8d3cdc782accfc86bb183dba"><div class="ttname"><a href="classSim__Param.html#a2f31362e8d3cdc782accfc86bb183dba">Sim_Param::cosmo</a></div><div class="ttdeci">Cosmo_Param cosmo</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00206">params.hpp:206</a></div></div>
<div class="ttc" id="grid_8h_html_a279b2fa20d574895e6286adb664cd1e9"><div class="ttname"><a href="grid_8h.html#a279b2fa20d574895e6286adb664cd1e9">sqrt</a></div><div class="ttdeci">Grid&lt; NDIM, T &gt; sqrt(Grid&lt; NDIM, T &gt; lhs)</div><div class="ttdef"><b>Definition:</b> <a href="grid_8h_source.html#l00231">grid.h:231</a></div></div>
<div class="ttc" id="precision_8hpp_html_a23f8a2188115cb3d27809adb429db284"><div class="ttname"><a href="precision_8hpp.html#a23f8a2188115cb3d27809adb429db284">FFTW_PLAN_OMP_CLEAN</a></div><div class="ttdeci">#define FFTW_PLAN_OMP_CLEAN</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00033">precision.hpp:33</a></div></div>
<div class="ttc" id="core__out_8cpp_html_a2efd6fa7e566267f1ede703138af72a1"><div class="ttname"><a href="core__out_8cpp.html#a2efd6fa7e566267f1ede703138af72a1">create_dir</a></div><div class="ttdeci">void create_dir(const std::string &amp;out_dir)</div><div class="ttdef"><b>Definition:</b> <a href="core__out_8cpp_source.html#l00074">core_out.cpp:74</a></div></div>
<div class="ttc" id="classSim__Param_html_ad7fc0f48d468b9bb78f5ff74e82af4ca"><div class="ttname"><a href="classSim__Param.html#ad7fc0f48d468b9bb78f5ff74e82af4ca">Sim_Param::test_opt</a></div><div class="ttdeci">Test_Opt test_opt</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00211">params.hpp:211</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02test__chameleon_8cpp_03_html_a8709442cd76b43b8ba10b02bef781eae"><div class="ttname"><a href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a8709442cd76b43b8ba10b02bef781eae">anonymous_namespace{test_chameleon.cpp}::get_neighbor_gridindex</a></div><div class="ttdeci">void get_neighbor_gridindex(std::vector&lt; size_t &gt; &amp;index_list, size_t i, size_t N)</div><div class="ttdef"><b>Definition:</b> <a href="test__chameleon_8cpp_source.html#l00020">test_chameleon.cpp:20</a></div></div>
<div class="ttc" id="classSim__Param_html_a66ac6a79379b67cbe941a0abb8efedbe"><div class="ttname"><a href="classSim__Param.html#a66ac6a79379b67cbe941a0abb8efedbe">Sim_Param::out_opt</a></div><div class="ttdeci">Out_Opt out_opt</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00204">params.hpp:204</a></div></div>
<div class="ttc" id="test__chameleon_8cpp_html_a657a834a319a49366487fe2221250852"><div class="ttname"><a href="test__chameleon_8cpp.html#a657a834a319a49366487fe2221250852">TEST_CASE</a></div><div class="ttdeci">TEST_CASE(&quot;UNIT TEST: create Multigrid and copy data to/from Mesh&quot;,&quot;[multigrid]&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="test__chameleon_8cpp_source.html#l00111">test_chameleon.cpp:111</a></div></div>
<div class="ttc" id="precision_8hpp_html_a281c03e36a8aa123ff492f0b5fbd9da9"><div class="ttname"><a href="precision_8hpp.html#a281c03e36a8aa123ff492f0b5fbd9da9">FFTW_PLAN_OMP</a></div><div class="ttdeci">#define FFTW_PLAN_OMP</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00031">precision.hpp:31</a></div></div>
<div class="ttc" id="structTest__Opt_html_aa9d524be0f8408c9b15bf0a016ca29e9"><div class="ttname"><a href="structTest__Opt.html#aa9d524be0f8408c9b15bf0a016ca29e9">Test_Opt::coarse_sweeps</a></div><div class="ttdeci">size_t coarse_sweeps</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00149">params.hpp:149</a></div></div>
<div class="ttc" id="namespaceccl__test__power_html_a1b5fdf14c4f06d4a8722a7c41d8dbe1a"><div class="ttname"><a href="namespaceccl__test__power.html#a1b5fdf14c4f06d4a8722a7c41d8dbe1a">ccl_test_power.argv</a></div><div class="ttdeci">argv</div><div class="ttdef"><b>Definition:</b> <a href="ccl__test__power_8py_source.html#l00166">ccl_test_power.py:166</a></div></div>
<div class="ttc" id="structRun__Opt_html_a5bcfeacfcc007d94efac7a1bb215666a"><div class="ttname"><a href="structRun__Opt.html#a5bcfeacfcc007d94efac7a1bb215666a">Run_Opt::nt</a></div><div class="ttdeci">size_t nt</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00134">params.hpp:134</a></div></div>
<div class="ttc" id="classMesh_html_aa0a3685f21d4bf9f7241c166bf6de087"><div class="ttname"><a href="classMesh.html#aa0a3685f21d4bf9f7241c166bf6de087">Mesh::N</a></div><div class="ttdeci">size_t N</div><div class="ttdef"><b>Definition:</b> <a href="class__mesh_8hpp_source.html#l00102">class_mesh.hpp:102</a></div></div>
<div class="ttc" id="classMultiGrid_html"><div class="ttname"><a href="classMultiGrid.html">MultiGrid&lt; 3, CHI_PREC_t &gt;</a></div></div>
<div class="ttc" id="precision_8hpp_html_a11fcca3b616ecb9d6cf05b3068a3efa2"><div class="ttname"><a href="precision_8hpp.html#a11fcca3b616ecb9d6cf05b3068a3efa2">FFTW_PLAN_TYPE</a></div><div class="ttdeci">#define FFTW_PLAN_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00026">precision.hpp:26</a></div></div>
<div class="ttc" id="classMesh__base_html_a6de1809464dd96aa985aa3141e1e4fe4"><div class="ttname"><a href="classMesh__base.html#a6de1809464dd96aa985aa3141e1e4fe4">Mesh_base::length</a></div><div class="ttdeci">size_t length</div><div class="ttdef"><b>Definition:</b> <a href="class__mesh_8hpp_source.html#l00032">class_mesh.hpp:32</a></div></div>
<div class="ttc" id="classSim__Param_html_a8df59df5e696db2bf7aa9260ae6ab123"><div class="ttname"><a href="classSim__Param.html#a8df59df5e696db2bf7aa9260ae6ab123">Sim_Param::run_opt</a></div><div class="ttdeci">Run_Opt run_opt</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00208">params.hpp:208</a></div></div>
<div class="ttc" id="classOfstream_html"><div class="ttname"><a href="classOfstream.html">Ofstream</a></div><div class="ttdef"><b>Definition:</b> <a href="core__out_8h_source.html#l00021">core_out.h:21</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02chameleon_8cpp_03_html_ab83251d24f40182ea733a2eef4d3937e"><div class="ttname"><a href="namespaceanonymous__namespace_02chameleon_8cpp_03.html#ab83251d24f40182ea733a2eef4d3937e">anonymous_namespace{chameleon.cpp}::min</a></div><div class="ttdeci">T min(const std::vector&lt; T &gt; &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="chameleon_8cpp_source.html#l00140">chameleon.cpp:140</a></div></div>
<div class="ttc" id="structTest__Opt_html_abacba4809c19fc88790728794cf498bc"><div class="ttname"><a href="structTest__Opt.html#abacba4809c19fc88790728794cf498bc">Test_Opt::N_grid</a></div><div class="ttdeci">size_t N_grid</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00150">params.hpp:150</a></div></div>
<div class="ttc" id="precision_8hpp_html_a5fedfe83ec3d318ed43c72e5f42f2861"><div class="ttname"><a href="precision_8hpp.html#a5fedfe83ec3d318ed43c72e5f42f2861">pow</a></div><div class="ttdeci">float pow(float base, unsigned long int exp)</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00039">precision.hpp:39</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02test__chameleon_8cpp_03_html_a9df5a2c1ea9aaaee33569bd05892e2e7"><div class="ttname"><a href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#a9df5a2c1ea9aaaee33569bd05892e2e7">anonymous_namespace{test_chameleon.cpp}::get_grav_pot</a></div><div class="ttdeci">void get_grav_pot(Mesh &amp;rho, const FFTW_PLAN_TYPE &amp;p_F, const FFTW_PLAN_TYPE &amp;p_B, double box_size, double phi_prefactor)</div><div class="ttdef"><b>Definition:</b> <a href="test__chameleon_8cpp_source.html#l00073">test_chameleon.cpp:73</a></div></div>
<div class="ttc" id="precision_8hpp_html_a28cc624e213909e713d2197891cbd5a8"><div class="ttname"><a href="precision_8hpp.html#a28cc624e213909e713d2197891cbd5a8">FFTW_PLAN_OMP_INIT</a></div><div class="ttdeci">#define FFTW_PLAN_OMP_INIT</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00032">precision.hpp:32</a></div></div>
<div class="ttc" id="classMesh__base_html_a3a99a6958058475cdfe263288151e850"><div class="ttname"><a href="classMesh__base.html#a3a99a6958058475cdfe263288151e850">Mesh_base::assign</a></div><div class="ttdeci">void assign(T val)</div><div class="ttdef"><b>Definition:</b> <a href="class__mesh_8hpp_source.html#l00038">class_mesh.hpp:38</a></div></div>
<div class="ttc" id="namespaceccl__test__distances_html_a6657d9200f3deee33876fcfbe909ad0b"><div class="ttname"><a href="namespaceccl__test__distances.html#a6657d9200f3deee33876fcfbe909ad0b">ccl_test_distances.h</a></div><div class="ttdeci">float h</div><div class="ttdef"><b>Definition:</b> <a href="ccl__test__distances_8py_source.html#l00022">ccl_test_distances.py:22</a></div></div>
<div class="ttc" id="structTest__Opt_html_af2092a24ca6b1491434ce50a89dd7edf"><div class="ttname"><a href="structTest__Opt.html#af2092a24ca6b1491434ce50a89dd7edf">Test_Opt::rho_b</a></div><div class="ttdeci">double rho_b</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00154">params.hpp:154</a></div></div>
<div class="ttc" id="classSim__Param_html_a2844b607e49ae018fbe8597be984a553"><div class="ttname"><a href="classSim__Param.html#a2844b607e49ae018fbe8597be984a553">Sim_Param::print_info</a></div><div class="ttdeci">void print_info(std::string out, std::string app) const </div><div class="ttdef"><b>Definition:</b> <a href="params_8cpp_source.html#l00497">params.cpp:497</a></div></div>
<div class="ttc" id="structOut__Opt_html_ab5d498b927d5d68709dd1a611d2e523b"><div class="ttname"><a href="structOut__Opt.html#ab5d498b927d5d68709dd1a611d2e523b">Out_Opt::out_dir</a></div><div class="ttdeci">std::string out_dir</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00086">params.hpp:86</a></div></div>
<div class="ttc" id="classCatch_1_1Detail_1_1Approx_html"><div class="ttname"><a href="classCatch_1_1Detail_1_1Approx.html">Catch::Detail::Approx</a></div><div class="ttdef"><b>Definition:</b> <a href="catch_8hpp_source.html#l02276">catch.hpp:2276</a></div></div>
<div class="ttc" id="namespaceanonymous__namespace_02test__chameleon_8cpp_03_html_aea22201ea94c61c9002645b660895808"><div class="ttname"><a href="namespaceanonymous__namespace_02test__chameleon_8cpp_03.html#aea22201ea94c61c9002645b660895808">anonymous_namespace{test_chameleon.cpp}::mean</a></div><div class="ttdeci">double mean(const Mesh &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="test__chameleon_8cpp_source.html#l00018">test_chameleon.cpp:18</a></div></div>
<div class="ttc" id="structTest__Opt_html_a672ef5869f774cdd15aad9e7979ce644"><div class="ttname"><a href="structTest__Opt.html#a672ef5869f774cdd15aad9e7979ce644">Test_Opt::fine_sweeps</a></div><div class="ttdeci">size_t fine_sweeps</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00149">params.hpp:149</a></div></div>
<div class="ttc" id="structTest__Opt_html_a96a06cb78d2a65ad74fd180b525603ed"><div class="ttname"><a href="structTest__Opt.html#a96a06cb78d2a65ad74fd180b525603ed">Test_Opt::N_min</a></div><div class="ttdeci">size_t N_min</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00150">params.hpp:150</a></div></div>
<div class="ttc" id="catch_8hpp_html_a836cca6b6ed3a1706353f6d1bca0935f"><div class="ttname"><a href="catch_8hpp.html#a836cca6b6ed3a1706353f6d1bca0935f">CHECK</a></div><div class="ttdeci">#define CHECK(...)</div><div class="ttdef"><b>Definition:</b> <a href="catch_8hpp_source.html#l13860">catch.hpp:13860</a></div></div>
<div class="ttc" id="precision_8hpp_html_aedb119751170eac2c67886d524de00f0"><div class="ttname"><a href="precision_8hpp.html#aedb119751170eac2c67886d524de00f0">FFTW_DEST_PLAN</a></div><div class="ttdeci">#define FFTW_DEST_PLAN</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00027">precision.hpp:27</a></div></div>
<div class="ttc" id="structChi__Opt_html_a5279fd76c5388819ae9f285dd9b67aad"><div class="ttname"><a href="structChi__Opt.html#a5279fd76c5388819ae9f285dd9b67aad">Chi_Opt::beta</a></div><div class="ttdeci">double beta</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00185">params.hpp:185</a></div></div>
<div class="ttc" id="chameleon_8cpp_html"><div class="ttname"><a href="chameleon_8cpp.html">chameleon.cpp</a></div><div class="ttdoc">chameleon model of gravity implementation </div></div>
<div class="ttc" id="structTest__Opt_html_a2e59a5cf8262a444cbc229f5d04318de"><div class="ttname"><a href="structTest__Opt.html#a2e59a5cf8262a444cbc229f5d04318de">Test_Opt::verbose</a></div><div class="ttdeci">bool verbose</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00151">params.hpp:151</a></div></div>
<div class="ttc" id="structTest__Opt_html_ae0512ff5aaaaf4f50cc2e985ad419dfd"><div class="ttname"><a href="structTest__Opt.html#ae0512ff5aaaaf4f50cc2e985ad419dfd">Test_Opt::max_steps</a></div><div class="ttdeci">size_t max_steps</div><div class="ttdef"><b>Definition:</b> <a href="params_8hpp_source.html#l00149">params.hpp:149</a></div></div>
<div class="ttc" id="core__mesh_8cpp_html_a72285b0564f202218b9c5742a7b3b936"><div class="ttname"><a href="core__mesh_8cpp.html#a72285b0564f202218b9c5742a7b3b936">sgn</a></div><div class="ttdeci">static int sgn(T val)</div><div class="ttdef"><b>Definition:</b> <a href="core__mesh_8cpp_source.html#l00015">core_mesh.cpp:15</a></div></div>
<div class="ttc" id="precision_8hpp_html_a1e4e2bcf89b30dfb7b0079da0c7dfd60"><div class="ttname"><a href="precision_8hpp.html#a1e4e2bcf89b30dfb7b0079da0c7dfd60">FFTW_PLAN_R2C</a></div><div class="ttdeci">#define FFTW_PLAN_R2C</div><div class="ttdef"><b>Definition:</b> <a href="precision_8hpp_source.html#l00029">precision.hpp:29</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_d4474ff605166111ff8bc117a4840290.html">ApproximationsSchemes</a></li><li class="navelem"><a class="el" href="dir_374e8c2660bb28ae2123ddf594ce71c3.html">tests</a></li><li class="navelem"><a class="el" href="test__chameleon_8cpp.html">test_chameleon.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
